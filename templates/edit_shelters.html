{% extends "base.html" %}

{% block title %}Gérer les refuges{% endblock %}

{% block content %}
<h1 class="edit-shelters-title">Gestion des Refuges</h1>

<div class="edit-shelters-container">
    {% for shelter in shelters %}
    <div class="edit-shelters-item">
        <img src="{{ url_for('static', filename='images/' + shelter.image) }}" alt="{{ shelter.name }}" class="edit-shelters-image">
        <div class="edit-shelters-info">
            <h2 class="edit-shelters-name">{{ shelter.name }}</h2>
            <p class="edit-shelters-address">{{ shelter.address }}</p>
            <p class="edit-shelters-contact">{{ shelter.phone }} | {{ shelter.email }}</p>
            <p class="edit-shelters-description">{{ shelter.description }}</p>
        </div>
        <div class="edit-shelters-actions">
            <a href="{{ url_for('edit_shelter', shelter_id=shelter.shelter_id) }}" class="edit-shelters-edit-btn">✏️</a>
            <form method="POST" action="{{ url_for('delete_shelter', shelter_id=shelter.shelter_id) }}" class="delete-shelter-form">
                <button type="submit" class="edit-shelters-delete-btn">❌</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>

<div class="edit-shelters-form-container">
<h2 class="edit-shelters-subtitle">Ajouter un refuge</h2>
<form method="POST" action="{{ url_for('edit_shelter') }}" enctype="multipart/form-data" class="edit-shelters-form">
    <input type="text" name="name" placeholder="Nom du refuge" required class="edit-shelters-input">
    <input type="text" name="address" placeholder="Adresse" required class="edit-shelters-input">
    <input type="text" name="phone" placeholder="Téléphone" required class="edit-shelters-input">
    <input type="email" name="email" placeholder="Email" required class="edit-shelters-input">
    <textarea name="description" placeholder="Description" class="edit-shelters-textarea" required class="edit-shelters-input"></textarea>

    <label for="image">Image du refuge :</label>
    <input type="file" id="image" name="image" accept=".png, .jpg, .jpeg, .gif" required class="edit-shelters-input" onchange="previewImage(event)">
    <small class="edit-shelters-info">Formats acceptés : PNG, JPG, JPEG, GIF</small>

    <div id="image-preview-container">
        <img id="image-preview" src="#" alt="Prévisualisation">
        <button type="button" onclick="removeImage()" class="edit-shelters-remove-btn">Retirer l'image</button>
    </div>

    <button type="submit" class="edit-shelters-btn">Ajouter</button>
</form>
</div>

<script>
function previewImage(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('image-preview').src = e.target.result;
            document.getElementById('image-preview-container').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
}

function removeImage() {
    document.getElementById('image').value = "";
    document.getElementById('image-preview-container').style.display = 'none';
}
</script>

{% endblock %}
